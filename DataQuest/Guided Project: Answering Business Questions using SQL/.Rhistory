---
title: "Investigatin COVID-19 Virus Trends"
output: html_notebook
---
library(readr)
---
title: "Investigatin COVID-19 Virus Trends"
output: html_notebook
---
---
title: "Investigatin COVID-19 Virus Trends"
output: html_notebook
---
library(readr)
library(readr)
library(readr)
read_csv(covid19.csv)
library(readr)
covid_df <- read_csv("covid19.csv")
covid_df <- read_csv("covid19.csv")
library(readr)
covid19 <- read_csv("Documents/programas/courses/DataQuest/Guided Project: Investigating COVID-19 Virus Trends/covid19.csv")
View(covid19)
View(covid19)
covid_df <- read_csv("Documents/programas/courses/DataQuest/Guided Project: Investigating COVID-19 Virus Trends/covid19.csv")
library(readr)
covid_df <- read_csv("Documents/programas/courses/DataQuest/Guided Project: Investigating COVID-19 Virus Trends/covid19.csv")
dim(covid_df)
dim(covid_df)
colnames(covid_df)
dim(covid_df)
vector_cols <- colnames(covid_df)
dim(covid_df)
vector_cols <- colnames(covid_df)
print(vector_cols)
---
title: "Investigatin COVID-19 Virus Trends"
output: html_notebook
---
library(readr)
---
title: "Investigatin COVID-19 Virus Trends"
output: html_notebook
---
library(readr)
covid_df <- read_csv("Documents/programas/courses/DataQuest/Guided Project: Investigating COVID-19 Virus Trends/covid19.csv")
dim(covid_df)
vector_cols <- colnames(covid_df)
print(vector_cols)
head(covid_df)
glimpse(covid_df)
library(readr)
library(tibble)
glimpse(covid_df)
library(readr)
library(tibble)
covid_df <- read_csv("Documents/programas/courses/DataQuest/Guided Project: Investigating COVID-19 Virus Trends/covid19.csv")
dim(covid_df)
vector_cols <- colnames(covid_df)
print(vector_cols)
head(covid_df)
glimpse(covid_df)
covid_df_all_states <- filter(covid_df, Province_State == "All States")
covid_df_all_states <- filter(covid_df, Province_State == "All States")
covid_df_all_states <- filter(covid_df, Province_State == "All States")
View(covid_df)
covid_df_all_states <- filter(covid_df, Province_State == All States)
covid_df_all_states <- filter(covid_df, Province_State == All States)
"
"
covid_df_all_states <- filter(covid_df, Province_State == "All States")
covid_df_all_states <- filter(covid_df, Province_State == "All States")
covid_df_all_states <- filter(covid_df, Province_State == "All States")
View(covid_df)
library(readr)
library(tibble)
covid_df <- read_csv("Documents/programas/courses/DataQuest/Guided Project: Investigating COVID-19 Virus Trends/covid19.csv")
dim(covid_df)
vector_cols <- colnames(covid_df)
print(vector_cols)
head(covid_df)
glimpse(covid_df)
covid_df_all_states <- filter(covid_df, Province_State == "All States")
View(covid_df)
glimpse(covid_df)
covid_df_all_states <- filter(covid_df, Province_State == "All States")
View(covid_df)
View(covid_df)
print(vector_cols)
covid_df_all_states <- covid_df[covid_df, Province_State == "All States"]
covid_df_all_states <- covid_df[covid_df$Province_State == "All States"]
covid_df_all_states <- filter(covid_df, covid_df$Province_State == "All States")
covid_df_all_states <- filter(covid_df, Province_State == "All States")
dim(covid_df)
dim(covid_df)
dim(covid_df)
dim(covid_df)
dim(covid_df)
dim(covid_df)
dim(covid_df)
dim(covid_df)
vector_cols <- colnames(covid_df)
print(vector_cols)
head(covid_df)
glimpse(covid_df)
covid_df_all_states <- filter(covid_df, Province_State == "All States")
View(covid_df)
print(covid_df$Province_State)
covid_df_all_states <- covid_df %>% filter(Province_State == 'All State')
covid_df_all_states <- covid_df %>% filter(covid_df,Province_State == 'All State')
covid_df_all_states <-filter(covid_df, Province_State == 'All State')
covid_df_all_states <-covid_df %>% filter(Province_State == "All States")
covid_df_all_states <-covid_df %>% filter(Province_State == "All States") %>% select(-Province_State)
library(readr)
library(readr)
library(readr)
covid_df <- read_csv("Documents/programas/courses/DataQuest/Guided Project: Investigating COVID-19 Virus Trends/covid19.csv")
dim(covid_df)
vector_cols <- colnames(covid_df)
print(vector_cols)
head(covid_df)
glimpse(covid_df)
covid_df_all_states <-covid_df %>% filter(Province_State == "All States") %>% select(-Province_State)
library(readr)
covid_df <- read_csv("Documents/programas/courses/DataQuest/Guided Project: Investigating COVID-19 Virus Trends/covid19.csv")
dim(covid_df)
vector_cols <- colnames(covid_df)
print(vector_cols)
head(covid_df)
glimpse(covid_df)
covid_df_all_states <-covid_df %>% filter(Province_State == "All States") %>% select(-Province_State)
source('~/Documents/programas/courses/DataQuest/Guided Project: Investigating COVID-19 Virus Trends/covidVirusTrend.R')
source('~/Documents/programas/courses/DataQuest/Guided Project: Investigating COVID-19 Virus Trends/covidVirusTrend.R')
covid_df <- read_csv("Documents/programas/courses/DataQuest/Guided Project: Investigating COVID-19 Virus Trends/covid19.csv")
covid_df <- read_csv("covid19.csv")
covid_df_all_states <- covid_df %>%
filter(Province_State == "All States") %>%
select(-Province_State)
covid_df_all_states <- covid_df %>%
filter(Province_State == "All States") %>%
select(-Province_State)
library(dplyr)
covid_df <- read_csv("Documents/programas/courses/DataQuest/Guided Project: Investigating COVID-19 Virus Trends/covid19.csv")
dim(covid_df)
vector_cols <- colnames(covid_df)
print(vector_cols)
head(covid_df)
glimpse(covid_df)
covid_df_all_states <- covid_df %>%
filter(Province_State == "All States") %>%
select(-Province_State)
library(dplyr)
install.packages('dplyr')
library(dplyr)
library(dplyr)
covid_df <- read_csv("Documents/programas/courses/DataQuest/Guided Project: Investigating COVID-19 Virus Trends/covid19.csv")
dim(covid_df)
vector_cols <- colnames(covid_df)
print(vector_cols)
head(covid_df)
glimpse(covid_df)
covid_df_all_states <- covid_df %>%
filter(Province_State == "All States") %>%
select(-Province_State)
library(tibble)
library(readr)
covid_df <- read_csv("Documents/programas/courses/DataQuest/Guided Project: Investigating COVID-19 Virus Trends/covid19.csv")
dim(covid_df)
vector_cols <- colnames(covid_df)
print(vector_cols)
head(covid_df)
library(tibble)
glimpse(covid_df)
library(dplyr)
covid_df_all_states <- covid_df %>%
filter(Province_State == "All States") %>%
select(-Province_State)
covid_df_all_states_daily <- select(covid_df_all_states, Country_Region, active, hospitalizeCurr, daily_tested, daily_positive)
covid_df_all_states_daily <- select(covid_df_all_states, Country_Region, active, hospitalizedCurr, daily_tested, daily_positive)
covid_df_all_states_daily_sum <- covid_df_all_states_daily %>%
group_by(Country_Region) %>%
sumarize(tested = sum(daily_tested),
positive = sum(daily_positive),
active = sum(active),
hospitalized = sum(hospitalizedCurr)) %>%
arrange(-tested)
covid_df_all_states_daily_sum <- covid_df_all_states_daily %>%
group_by(Country_Region) %>%
summarize(tested = sum(daily_tested),
positive = sum(daily_positive),
active = sum(active),
hospitalized = sum(hospitalizedCurr)) %>%
arrange(-tested)
View(covid_df_all_states_daily)
View(covid_df_all_states_daily_sum)
covid_df_all_states_daily_sum
covid_top_10 <- head(covid_df_all_states_daily_sum, 10)
names(tested_cases) <- countries
countries <- covid_top_10$Country_Region
countries <- covid_top_10$Country_Region
countries <- covid_top_10$Country_Region
countries <- covid_top_10$Country_Region
countries <- covid_top_10$Country_Region
countries <- covid_top_10$Country_Region
tested_cases <- covid_top_10$tested
positive_cases <-  covid_top_10$positive
active_cases <- covid_top_10$active
hopitalized_cases <-  covid_top_10$hospitalized
names(tested_cases) <- countries
print(tested_cases)
names(hospitalized_cases) <- countries
names(active_cases) <- countries
names(active_cases) <- countries
names(active_cases) <- countries
names(hospitalized_cases) <- countries
hopitalized_cases <-  covid_top_10$hospitalized
names(tested_cases) <- countries
names(positive_cases) <- countries
names(active_cases) <- countries
names(hospitalized_cases) <- countries
names(hopitalized_cases) <- countries
positive_tested_top_3 <- positive_cases/tested_cases
print(positive_tested_top_3)
print(positive_tested_top_3)
positive_tested_top_3 <- positive_cases/tested_cases %>% arrange()
print(positive_tested_top_3)
positive_tested_top_3 <- positive_cases/tested_cases %>% max()
positive_tested_top_3 <- positive_cases/tested_cases %>% max()
positive_tested_top_3 <- positive_cases/tested_cases %>% max()
print(positive_tested_top_3)
positive_tested_top_3 <- positive_cases/tested_cases %>% max()[:3]
positive_tested_top_3 <- positive_cases/tested_cases %>% max()[:3]
positive_tested_top_3 <- positive_tested_top_3[:3]
positive_tested_top_3 <- positive_cases/tested_cases %>% max()
positive_tested_top_3 <- positive_tested_top_3[:3]
print(positive_tested_top_3)
positive_tested_top_3 <- positive_tested_top_3[3]
print(positive_tested_top_3)
positive_tested_top_3 <- positive_tested_top_3[c(1,2,3)]
print(positive_tested_top_3)
positive_tested_top_3 <- positive_cases/tested_cases %>% max()
positive_tested_top_3 <- positive_tested_top_3[c(1,2,3)]
print(positive_tested_top_3)
positive_tested_top_3 <- positive_cases/tested_cases %>% min()
positive_tested_top_3 <- positive_tested_top_3[c(1,2,3)]
print(positive_tested_top_3)
positive_tested_top_3 <- positive_cases/tested_cases %>% arrange()
positive_tested_top_3 <- positive_cases/tested_cases
print(positive_tested_top_3)
positive_tested_top_3 <- positive_cases/tested_cases %>% min()
print(positive_tested_top_3)
positive_tested_top_3 <- positive_cases/tested_cases %>% max()
print(positive_tested_top_3)
positive_tested_top_3 <- positive_cases/tested_cases %>% sort()
print(positive_tested_top_3)
positive_tested_top_3 <- sort(positive_cases/tested_cases)
print(positive_tested_top_3)
positive_tested_top_3 <- sort(positive_cases/tested_cases, decreasing = F)
print(positive_tested_top_3)
positive_tested_top_3 <- sort(positive_cases/tested_cases, decreasing = T)
print(positive_tested_top_3)
positive_tested_top_3 <- positive_tested_top_3[c(1,2,3)]
print(positive_tested_top_3)
print(positive_tested_top_3)
positive_tested_top_3 <- positive_tested_top_3[c(1,2,3)] %>% round(2)
print(positive_tested_top_3)
covid_mat <- rbind(united_kingdom, united_states, turkey)
covid_mat <- rbind(united_kingdom, united_states, turkey)
covid_mat <- rbind(united_kingdom, united_states, turkey)
covid_mat <- rbind( united_states, turkey)
united_kingdom <-  c(0.11, 1473672, 166909, 0, 0)
united_states  <-  c(0.10, 17282363, 1877179, 0, 0)
turkey <- c(0.08, 2031192, 163941, 2980960, 0)
covid_mat <- rbind(united_kingdom, united_states, turkey)
covid_mat <- rbind(united_kingdom, united_states, turkey)
colnames(covid_mat) <- c("Ratio", "tested", "positive", "active", "hospitalized")
print(covid_mat)
question <- "Which countries have had the highest number of positive cases against the number of tests?"
answer <- c("Positive tested cases" = positive_tested_top_3)
print(answer)
matrices <- c(covid_mat)
dataframes <- c(covid_df, covid_df_all_states, covid_df_all_states_daily,
covid_df_all_states_daily_sum)
matrices <- c(covid_mat)
hopitalized_cases
vectores <- c(countries, tested_cases, positive_cases, active_cases,
hospitalized_cases, united_kingdom, united_states, turkey)
library(readr)
covid_df <- read_csv("Documents/programas/courses/DataQuest/Guided Project: Investigating COVID-19 Virus Trends/covid19.csv")
dim(covid_df)
vector_cols <- colnames(covid_df)
print(vector_cols)
head(covid_df)
library(tibble)
glimpse(covid_df)
library(dplyr)
covid_df_all_states <- covid_df %>%
filter(Province_State == "All States") %>%
select(-Province_State)
covid_df_all_states_daily <- select(covid_df_all_states,
Country_Region, active, hospitalizedCurr,
daily_tested, daily_positive)
covid_df_all_states_daily_sum <- covid_df_all_states_daily %>%
group_by(Country_Region) %>%
summarize(tested = sum(daily_tested),
positive = sum(daily_positive),
active = sum(active),
hospitalized = sum(hospitalizedCurr)) %>%
arrange(-tested)
covid_df_all_states_daily_sum
covid_top_10 <- head(covid_df_all_states_daily_sum, 10)
countries <- covid_top_10$Country_Region
tested_cases <- covid_top_10$tested
positive_cases <-  covid_top_10$positive
active_cases <- covid_top_10$active
hospitalized_cases <-  covid_top_10$hospitalized
names(tested_cases) <- countries
names(positive_cases) <- countries
names(active_cases) <- countries
names(hospitalized_cases) <- countries
positive_tested_top_3 <- sort(positive_cases/tested_cases, decreasing = T)
print(positive_tested_top_3)
positive_tested_top_3 <- positive_tested_top_3[c(1,2,3)] %>% round(2)
print(positive_tested_top_3)
united_kingdom <-  c(0.11, 1473672, 166909, 0, 0)
united_states  <-  c(0.10, 17282363, 1877179, 0, 0)
turkey <- c(0.08, 2031192, 163941, 2980960, 0)
covid_mat <- rbind(united_kingdom, united_states, turkey)
colnames(covid_mat) <- c("Ratio", "tested", "positive", "active", "hospitalized")
print(covid_mat)
question <- "Which countries have had the highest number of positive cases against the number of tests?"
answer <- c("Positive tested cases" = positive_tested_top_3)
dataframes <- c(covid_df, covid_df_all_states, covid_df_all_states_daily,
covid_df_all_states_daily_sum)
matrices <- c(covid_mat)
vectores <- c(countries, tested_cases, positive_cases, active_cases,
hospitalized_cases, united_kingdom, united_states, turkey)
data_structure_list <- list(dataframes = dataframes)
print(data_structure_list)
data_structure_list <- list("dataframes" = dataframes, "matrix"= matrices, "vector" = vectores)
print(data_structure_list)
covid_analysis_list <- list(question, answer, data_structure_list)
print(covid_analysis_list[2])
library(RSQLite)
install.packages('RSQLite')
library(RSQLite)
library(DBI)
library(RSQLite)
library(DBI)
library(RSQLite)
library(DBI)
setwd("~/Documents/programas/courses/DataQuest/Guided Project: Answering Business Questions using SQL")
run_query <- function(query){
conn <- dbConnect('chinook.db')
result <- dbGetQuery(conn, querry)
dbDisconnect(conn)
result
}
run_query('SELECT * FROM customers')
library(RSQLite)
library(DBI)
run_query <- function(query){
conn <- dbConnect('chinook.db')
result <- dbGetQuery(conn, querry)
dbDisconnect(conn)
result
}
run_query('SELECT * FROM customers')
run_query <- function(query){
conn <- dbConnect('chinook.db')
result <- dbGetQuery(conn, querry)
dbDisconnect(conn)
return(result)
}
run_query('SELECT * FROM customers')
run_query <- function(query){
conn <- dbConnect('chinook.db')
result <- dbGetQuery(conn, querry)
dbDisconnect(conn)
return(result)
}
run_query('SELECT * FROM customers')
run_query <- function(query){
conn <- dbConnect(sqlite(), 'chinook.db')
result <- dbGetQuery(conn, querry)
dbDisconnect(conn)
return(result)
}
run_query('SELECT * FROM customers')
conn <- dbConnect(SQLite(), 'chinook.db')
run_query <- function(query){
conn <- dbConnect(SQLite(), 'chinook.db')
result <- dbGetQuery(conn, querry)
dbDisconnect(conn)
return(result)
}
run_query('SELECT * FROM customers')
run_query <- function(query){
conn <- dbConnect(SQLite(), 'chinook.db')
result <- dbGetQuery(conn, query)
dbDisconnect(conn)
return(result)
}
run_query('SELECT * FROM customers')
run_query('SELECT * FROM customer')
run_query('SHOW TABLES')
show_tables <- functio(){
show_tables <- function(){
run_query('SHOW TABLES')
}
show_tables()
run_query('SHOW TABLES;')
show_tables <- function(){
run_query('SHOW TABLES;')
}
show_tables()
show_tables <- function(){
run_query('SHOW TABLES;')
}
show_tables()
show_tables <- function(){
run_query('SELECT name FROM my_db.sqlite_mater WHERE type = "table"')
}
show_tables <- function(){
run_query('SELECT name FROM my_db.sqlite_mater WHERE type = "table"')
}
show_tables()
run_query('SELECT name FROM chinook.sqlite_mater WHERE type = "table"')
show_tables <- function(){
run_query('SELECT name FROM chinook.sqlite_mater WHERE type = "table"')
}
show_tables()
show_tables <- function(){
run_query("SELECT name FROM sqlite_master WHERE type='table'")
}
show_tables()
query <- '
SELECT
g.name as genre,
count(il.invoice_id) as tracks_sold
FROM genre
LEFT JOIN track tr ON g.genre_id = tr.genre_id
LEFT JOIN invoice_line il ON il.track_id = tr.track_id
'
run_query(query)
query <- '
SELECT
g.name,
count(il.invoice_id) as tracks_sold
FROM genre
LEFT JOIN track tr ON g.genre_id = tr.genre_id
LEFT JOIN invoice_line il ON il.track_id = tr.track_id
'
run_query(query)
albums_to_purchase = '
WITH usa_tracks_sold AS
albums_to_purchase
print(albums_to_purchase)
query <- '
SELECT
run_query(query)
query <- '
SELECT
g.name,
count(il.invoice_id) as tracks_sold
FROM genre
LEFT JOIN track tr ON g.genre_id = tr.genre_id
LEFT JOIN invoice_line il ON il.track_id = tr.track_id
'
run_query(query)
print(albums_to_purchase)
albums_to_purchase = '
WITH usa_tracks_sold AS
(
SELECT il.* FROM invoice_line il
INNER JOIN invoice i on il.invoice_id = i.invoice_id
INNER JOIN customer c on i.customer_id = c.customer_id
WHERE c.country = "USA"
)
SELECT
g.name genre,
count(uts.invoice_line_id) tracks_sold,
cast(count(uts.invoice_line_id) AS FLOAT) / (
SELECT COUNT(*) from usa_tracks_sold
) percentage_sold
FROM usa_tracks_sold uts
INNER JOIN track t on t.track_id = uts.track_id
INNER JOIN genre g on g.genre_id = t.genre_id
GROUP BY 1
ORDER BY 2 DESC
LIMIT 10;
'
print(albums_to_purchase)
query <- '
SELECT
g.name,
count(il.invoice_id) as tracks_sold
FROM genre as g
LEFT JOIN track tr ON g.genre_id = tr.genre_id
LEFT JOIN invoice_line il ON il.track_id = tr.track_id
'
run_query(query)
query <- '
SELECT
g.name as genre,
count(il.invoice_id) as tracks_sold
FROM genre as g
LEFT JOIN track tr ON g.genre_id = tr.genre_id
LEFT JOIN invoice_line il ON il.track_id = tr.track_id
GROUP BY 1
'
run_query(query)
